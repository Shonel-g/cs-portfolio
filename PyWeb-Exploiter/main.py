import argparse
from modules.sqli import SQLInjector
from modules.cmd import CommandInjector

def main():
    print(r"""
    ____      _       __     __      
   / __ \_  _| |     / /__  / /_     
  / /_/ / // / | /| / / _ \/ __ \    
 / ____/ /_//| |/ |/ /  __/ /_/ /    
/_/    \__, /|__/|__/\___/_.___/     
      /____/   v1.3 - Ethical Hacking Tool                  
    """)

    parser = argparse.ArgumentParser(description="Automated Web Exploitation Tool")
    parser.add_argument("url", help="Target URL (e.g., https://site.com/login)")
    parser.add_argument("--attack", choices=['sqli-login', 'cmd-injection'], required=True, help="Type of attack to perform")
    
    # Optional arguments depending on the attack type
    parser.add_argument("--user-field", default="username", help="Field name for username (SQLi)")
    parser.add_argument("--pass-field", default="password", help="Field name for password (SQLi)")
    parser.add_argument("--param", default="storeId", help="Vulnerable parameter name (Cmd Injection)")

    args = parser.parse_args()

    # --- SQL INJECTION MODE ---
    if args.attack == 'sqli-login':
        print("[*] Mode: SQL Injection (Login Bypass)")
        injector = SQLInjector(args.url)
        injector.run_login_bypass(args.user_field, args.pass_field)

    # --- COMMAND INJECTION MODE ---
    elif args.attack == 'cmd-injection':
        print("[*] Mode: OS Command Injection")
        injector = CommandInjector(args.url)
        injector.run_simple_injection(args.param)

if __name__ == "__main__":
    main()
